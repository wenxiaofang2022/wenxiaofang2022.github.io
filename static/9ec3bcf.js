(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{511:function(e,t,r){var content=r(552);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(53).default)("298fb01c",content,!0,{sourceMap:!1})},529:function(e,t,r){"use strict";r.r(t);r(46),r(26),r(54);var n=r(2),o=r(229),c=r(189),d=r(188),l=(r(126),r(41)),h=r(0),f=r(1),w=r(3),m=r(79),y=r(4);r(36),r(340),r(341),r(35),r(101),r(100),r(338),r(216),r(217),r(62),r(190),r(224),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201),r(202),r(203),r(204),r(205),r(206),r(207),r(208),r(209),r(210),r(211),r(212),r(213),r(48),r(220),r(218),r(223),r(343),r(214),r(219);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(y.a)(e);if(t){var o=Object(y.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(m.a)(this,r)}}var k=new WeakMap,D=function(e){Object(w.a)(r,e);var t=v(r);function r(e){var n;return Object(h.a)(this,r),(n=t.call(this,e)).decoderPath="",n.decoderConfig={},n.decoderBinary=null,n.decoderPending=null,n.workerLimit=4,n.workerPool=[],n.workerNextTaskID=1,n.workerSourceURL="",n.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},n.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},n}return Object(f.a)(r,[{key:"setDecoderPath",value:function(path){return this.decoderPath=path,this}},{key:"setDecoderConfig",value:function(e){return this.decoderConfig=e,this}},{key:"setWorkerLimit",value:function(e){return this.workerLimit=e,this}},{key:"load",value:function(e,t,r,o){var c=this,d=new n.s(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,(function(e){c.decodeDracoFile(e,t).catch(o)}),r,o)}},{key:"decodeDracoFile",value:function(e,t,r,n){var o={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,o).then(t)}},{key:"decodeGeometry",value:function(e,t){var r,n=this,o=JSON.stringify(t);if(k.has(e)){var c=k.get(e);if(c.key===o)return c.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var d=this.workerNextTaskID++,l=e.byteLength,h=this._getWorker(d,l).then((function(n){return r=n,new Promise((function(n,o){r._callbacks[d]={resolve:n,reject:o},r.postMessage({type:"decode",id:d,taskConfig:t,buffer:e},[e])}))})).then((function(e){return n._createGeometry(e.geometry)}));return h.catch((function(){return!0})).then((function(){r&&d&&n._releaseTask(r,d)})),k.set(e,{key:o,promise:h}),h}},{key:"_createGeometry",value:function(e){var t=new n.i;e.index&&t.setIndex(new n.h(e.index.array,1));for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i],o=r.name,c=r.array,d=r.itemSize;t.setAttribute(o,new n.h(c,d))}return t}},{key:"_loadLibrary",value:function(e,t){var r=new n.s(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((function(t,n){r.load(e,t,void 0,n)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==("undefined"==typeof WebAssembly?"undefined":Object(l.a)(WebAssembly))||"js"===this.decoderConfig.type,r=[];return t?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then((function(r){var n=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var o=P.toString(),body=["/* draco decoder */",n,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([body]))})),this.decoderPending}},{key:"_getWorker",value:function(e,t){var r=this;return this._initDecoder().then((function(){if(r.workerPool.length<r.workerLimit){var n=new Worker(r.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(e){var t=e.data;switch(t.type){case"decode":n._callbacks[t.id].resolve(t);break;case"error":n._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(n)}else r.workerPool.sort((function(a,b){return a._taskLoad>b._taskLoad?-1:1}));var o=r.workerPool[r.workerPool.length-1];return o._taskCosts[e]=t,o._taskLoad+=t,o}))}},{key:"_releaseTask",value:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))}},{key:"dispose",value:function(){for(var i=0;i<this.workerPool.length;++i)this.workerPool[i].terminate();return this.workerPool.length=0,this}}]),r}(n.L);function P(){var e,t;function r(e,t,r,n,o,c){var d=c.num_components(),l=r.num_points()*d,h=l*o.BYTES_PER_ELEMENT,f=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,o),w=e._malloc(h);t.GetAttributeDataArrayForAllPoints(r,c,f,h,w);var m=new o(e.HEAPF32.buffer,w,l).slice();return e._free(w),{name:n,array:m,itemSize:d}}onmessage=function(n){var o=n.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var c=o.buffer,d=o.taskConfig;t.then((function(e){var t=e.draco,n=new t.Decoder,l=new t.DecoderBuffer;l.Init(new Int8Array(c),c.byteLength);try{var h=function(e,t,n,o){var c,d,l=o.attributeIDs,h=o.attributeTypes,f=t.GetEncodedGeometryType(n);if(f===e.TRIANGULAR_MESH)c=new e.Mesh,d=t.DecodeBufferToMesh(n,c);else{if(f!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");c=new e.PointCloud,d=t.DecodeBufferToPointCloud(n,c)}if(!d.ok()||0===c.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());var w={index:null,attributes:[]};for(var m in l){var y=self[h[m]],v=void 0,k=void 0;if(o.useUniqueIDs)k=l[m],v=t.GetAttributeByUniqueId(c,k);else{if(-1===(k=t.GetAttributeId(c,e[l[m]])))continue;v=t.GetAttribute(c,k)}w.attributes.push(r(e,t,c,m,y,v))}f===e.TRIANGULAR_MESH&&(w.index=function(e,t,r){var n=3*r.num_faces(),o=4*n,c=e._malloc(o);t.GetTrianglesUInt32Array(r,o,c);var d=new Uint32Array(e.HEAPF32.buffer,c,n).slice();return e._free(c),{array:d,itemSize:1}}(e,t,c));return e.destroy(c),w}(t,n,l,d),f=h.attributes.map((function(e){return e.array.buffer}));h.index&&f.push(h.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:h},f)}catch(e){console.error(e),self.postMessage({type:"error",id:o.id,error:e.message})}finally{t.destroy(l),t.destroy(n)}}))}}}var _={name:"OilContent",props:["glburl"],data:function(){return{object:null,scene:null,camera:null,renderer:null,textloader:null,controls:null,group:null,width:0,height:0,center:null,activeIndex:0,onPointerDownPointerX:null,onPointerDownPointerY:null,logopath:{"云栖盲盒":"apsara.2020","伸爪":"vans","天猫live":"tmall.live","天猫国际全球好物课代表":"tmall.global","天生艺术":"utalent","淘宝回忆":"taobao.memory",ADIC:"ali.adic",HEY_DESIGN:"heydesign",OMOJI:"oppoo.moji","十大商品6":"taobaotop","发发奇":"farfetch","发发奇会员":"vipfarfetch","天猫主题店2":"tmall2","天猫主题店第一期":"tmall","宝藏新品牌":"tmallnew","超级视窗":"taobao.superwindow","飞猪2":"fliggy","麦当劳":"mcdonald.nft","东京奥运会":"tokyo2020","乐高":"lego","云栖大会2021":"ali.apsara","城市缝隙迷行贴纸":"city","观夏":"mixplace","造物节":"taobao2022","长江":"changjiang","不完全命理指南":"jinyu","节日不打烊2020":"nostop","节日不打烊2021":"nostop2021","菇得来福":"goodlife"}}},watch:{},mounted:function(){this.$nextTick(this.init)},methods:{init:function(){var e=this.$refs.webglDom;this.width=e.offsetWidth,this.height=e.offsetHeight,this.scene=new n.Ab,this.textloader=new n.Kb,this.group=new n.v,this.camera=new n.eb(45,this.width/this.height,.01,1e4),this.camera.position.set(0,0,0),console.log("this.camera",this.camera),this.camera.lookAt(0,0,0),this.scene.add(this.camera),this.loadModel(),e.addEventListener("mousedown",this.onDocumentMouseDown,!1),document.addEventListener("touchstart",this.onDocumentTouchDown,!1),document.addEventListener("touchend",this.onDocumentTouchUp,!1),document.addEventListener("touchmove",this.onDocumentTouchMove,!1)},onDocumentTouchDown:function(e){this.startX=e.touches[0].pageX,this.startY=e.touches[0].pageY,this.onPointerDownPointerX=e.touches[0].pageX,this.onPointerDownPointerY=e.touches[0].pageY},onDocumentTouchMove:function(e){this.onPointerDownPointerX=e.touches[0].pageX,this.onPointerDownPointerY=e.touches[0].pageY,this.endX=e.touches[0].pageX,this.endY=e.touches[0].pageY},onDocumentTouchUp:function(e){},onDocumentMouseDown:function(e){var t=this.getIntersects(e);if(console.log("intersects",t),0!==t.length&&"Mesh"===t[0].object.type){var r=t[0].object;console.log("selectObject",r.name);var path=this.logopath[r.name];if(!path)return;this.$router.push({path:"/caselist/"+path})}else console.log("未选中 Mesh!")},getIntersects:function(e,t){t||e.preventDefault();var r=new n.xb,o=new n.Ob;return t?e.clientX?(o.x=e.clientX/window.innerWidth*2-1,o.y=-e.clientY/window.innerHeight*2+1):(o.x=this.onPointerDownPointerX/window.innerWidth*2-1,o.y=-this.onPointerDownPointerY/window.innerHeight*2+1):(o.x=e.clientX/window.innerWidth*2-1,o.y=-e.clientY/window.innerHeight*2+1),r.setFromCamera(o,this.camera),r.intersectObjects(this.group.children,!0)},changeCamera:function(e){var object=e.scene||e.scenes[0],t=(new n.f).setFromObject(object),r=t.getSize(new n.Pb(0,0,0)).length(),d=t.getCenter(new n.Pb(0,0,0));object.position.x+=object.position.x-d.x,object.position.y+=object.position.y-d.y,object.position.z+=object.position.z-d.z,object.scale.set(.96,.96,.96),object.translateY(.1),this.camera.near=r/100,this.camera.far=100*r,this.camera.position.copy(d),this.camera.position.x+=r/2,this.camera.position.y+=r/5,this.camera.position.z+=r/2,this.camera.lookAt(d),this.camera.up=new n.Pb(0,1,0),this.camera.updateProjectionMatrix(),this.object=object,this.group.add(this.object),this.scene.add(this.group),this.printGraph(object),this.renderer=new n.Rb({antialias:!0}),this.renderer.outputEncoding=n.Sb,this.renderer.toneMapping=n.a,this.renderer.toneMappingExposure=1.2,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=n.cb,this.renderer.setClearColor(new n.l("#000000"),0),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.setSize(this.width,this.height),this.$refs.webglDom.appendChild(this.renderer.domElement);var l=new c.a,h=new n.db(this.renderer);this.scene.environment=h.fromScene(l).texture;var f=new o.a(this.camera,this.renderer.domElement);f.enablePan=!1,f.enableZoom=!1,f.minPolarAngle=Math.PI/3,f.maxPolarAngle=Math.PI/2,this.controls=f,this.render()},loadModel:function(){var e=this,t=new d.a,r=new D;r.setDecoderPath("/js/libs/draco/"),r.setDecoderConfig({type:"js"}),r.preload(),t.setDRACOLoader(r),t.load(this.glburl,(function(t){console.log("gltf",t),e.changeCamera(t)}),(function(t){var r=Math.floor(t.loaded/t.total*100);e.$emit("judgerate",r)}))},printGraph:function(e){var t=this;console.log("node.children.length",e.children.length),console.group(" <"+e.type+"> "+e.name),e.children.forEach((function(e){return t.printGraph(e)})),console.groupEnd()},addLight:function(){var e=1e3,t=new n.b(16777215,.5);this.add(t);var r=new n.p(16777215,.5);r.position.set(0,e,e),this.add(r);var o=new n.p(16777215,.5);o.position.set(-1e3,e,e),this.add(o);var c=new n.p(16777215,.5);c.position.set(e,e,e),this.add(c);var d=new n.p(16777215,.5);d.position.set(0,e,-1e3),this.add(d);var l=new n.p(16777215,.5);l.position.set(0,-1e3,-1e3),this.add(l)},add:function(e){this.scene.add(e)},render:function(){this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.render)}}},A=(r(551),r(30)),component=Object(A.a)(_,(function(){return(0,this._self._c)("div",{ref:"webglDom",staticClass:"webglDom"})}),[],!1,null,"1a76ccf8",null);t.default=component.exports},551:function(e,t,r){"use strict";r(511)},552:function(e,t,r){var n=r(52)(!1);n.push([e.i,".webglDom[data-v-1a76ccf8]{width:100%;height:100%;position:relative;z-index:1}",""]),e.exports=n}}]);